![image.png](https://s2.loli.net/2025/09/03/XlmNSwVv49ArhRZ.png)


```R
cor_res <- corr.test(x, y, method = "spearman", adjust = "none")
# x,y::mateix row is feature, column is samples

library(corrplot)
library(RColorBrewer)
pdf(file = str_glue("{od}/Figure_spearman_cor_heatmap.pdf"), width = 10, height = 6)
corrplot(cor_res$r,
    method = "circle", tl.col = "black",
    is.corr = FALSE,
    tl.srt = 45,
    tl.cex = 1,# 字体大小和角度
    p.mat = cor_res$p,
    insig = "label_sig",#"pch", "p-value", "blank", "n", "label_sig"
    sig.level = c(0.0001, 0.001, 0.01, 0.05),
    pch.cex = 1,
    # order = "hclust",
    tl.pos = "lt",# 标签位置
    # col = rev(brewer.pal(n = 8, name = "RdBu")), # 或者
    col = colorRampPalette(c("blue", "white", "red"))(100),
    type = "full" # upper, lower
)
dev.off()


```