## 假设检验

在目前的断言下，现实中观察到的事件发生的概率有多小（可以设置概率阈值α，作为判断是否显著的标准）。

对于单个总体的正态分布，在总体的方差（σ2）已知情况下用Z检验，在σ2未知情况下用t检验

假设检验是建立在H0假设为真条件下的，可以通过下边例题感受下。

## t分布公式推导

Z服从标准正态分布

![](https://cdn.nlark.com/yuque/__latex/7c82d456e03b2631237b2106ef336615.svg)

用样本标准差S代表总体标准差

![](https://cdn.nlark.com/yuque/__latex/f08dbe2d4b49e2a7cdf66c2cb9aed468.svg)

因为

![](https://cdn.nlark.com/yuque/__latex/e17a4853eb615435783e9712fc3e45a8.svg)

所以

![](https://cdn.nlark.com/yuque/__latex/4e189a70cac4714fd17b81c3d41dd8a5.svg)

所以

![](https://cdn.nlark.com/yuque/__latex/fd307f7f96b8f2dcdaf56c8cf2e2b098.svg)

其中X服从标准正态分布，Y服从卡方分布

![](https://cdn.nlark.com/yuque/__latex/5f84ad1889e2a2ae9befda17fad25a7b.svg)

## t分布与Z分布区别

总体标准差σ已知，用Z分布

用样本标准差S代表总体标准差σ，用t分布

当自由度df越大时，t分布越接近Z分布

```
using CairoMakie,Distributions
let
    f=Figure()
    Axis(f[1, 1])
    x = -3:0.1:3
    lines!(x, pdf.(Normal(0,1), x),color=:red, label = "Normal")
    for df in 1:3:10
        lines!(x, pdf.(TDist(df), x), label = "df = $df")
    end
    axislegend()
    current_figure()
end
```

![image.png](https://s2.loli.net/2025/09/08/L2TbiDRUfuAnvMd.png)


## t检验

- dataset

A data set called ncbirths represents a random sample of 150 cases of mothers and their newborns in North Carolina over a year. We would like to know, is there convincing evidence that newborns from mothers who smoke have a different average birth weight than newborns from mothers who don’t smoke?

|   |   |   |
|---|---|---|
||smoker|nonsmoker|
|mean (x)|6.804|7.144|
|SD (S)|1.410|1.519|
|sample size (n)|127|873|

- hypothesis

The null hypothesis represents the case of no difference between the groups. `**H0**`: There is no difference in average birth weight for newborns from mothers who did and did notsmoke. In statistical notation: µn − µs = 0, where µn represents non-smoking mothers and µs represents mothers who smoked. `**HA**`: There is some difference in average newborn weights from mothers who did and did not smoke (µn − µs).

假定H0为真，则μn−μs=0，把S、n、![](https://cdn.nlark.com/yuque/__latex/6434f058a27806cea31fdcc61d4bfa69.svg)带入公式，算出t值。

![](https://cdn.nlark.com/yuque/__latex/3b187fa0e6635a126ca07138d54ac750.svg)

自由度 df=1000-2=998

去查表可以得到在置信度为0.05的条件下，双侧检验的p<0.05，因此接受H**A**

# Python中的t 检验

可以参考之前的推送[Python基本统计分析](https://mp.weixin.qq.com/s/7Cm-PpH29SvhXydo6NwG5w)

## Julia中的t检验

```
ncbirth=CSV.read("ncbirths.csv",DataFrame);
nonsmoker = ncbirth[ncbirth.habit .== "nonsmoker",:].weight;
smoker = ncbirth[ncbirth.habit .!= "nonsmoker",:].weight;
# 1000×13 DataFrame
#   Row │ fage     mage   mature       weeks    premie     visits   marital      ⋯
#       │ String3  Int64  String15     String3  String15   String3  String15     ⋯
# ──────┼─────────────────────────────────────────────────────────────────────────
#     1 │ NA          13  younger mom  39       full term  10       not married  ⋯
#     2 │ NA          14  younger mom  42       full term  15       not married
#     3 │ 19          15  younger mom  37       full term  11       not married
```

- 正态、方差检验

```
using HypothesisTests, Statistics, Distributions

# 符合正态分布
ExactOneSampleKSTest(nonsmoker,Normal()) |> pvalue < 0.05
ExactOneSampleKSTest(smoker,Normal()) |> pvalue < 0.05

# 方差齐
LeveneTest(nonsmoker,smoker) |> pvalue > 0.05
```

- t检验

```
EqualVarianceTTest(nonsmoker,smoker)
# Two sample t-test (equal variance)
# ----------------------------------
# Population details:
#     parameter of interest:   Mean difference
#     value under h_0:         0
#     point estimate:          0.340729
#     95% confidence interval: (0.06019, 0.6213)

# Test summary:
#     outcome with 95% confidence: reject h_0
#     two-sided p-value:           0.0173

# Details:
#     number of observations:   [873,127]
#     t-statistic:              2.383331290495289
#     degrees of freedom:       998
#     empirical standard error: 0.1429634719314201
```

- t分布

```
using CairoMakie,Distributions
let
    f=Figure()
    Axis(f[1, 1])
    x = -5:0.1:5
    lines!(x, pdf.(TDist(998), x), label = "df = 998")
    vlines!([1.54,-1.54],ymax=0.31,color=:red)
    axislegend()
    current_figure()
end
```

![](https://s2.loli.net/2025/09/08/L2TbiDRUfuAnvMd.png)

## Reference

```
https://introprobabilityandstatistics.pressbooks.tru.ca/wp-content/uploads/sites/113/2022/06/openintro-statistics_7_3.pdf
```